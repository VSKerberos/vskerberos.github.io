"use strict";(self.webpackChunkcost_calculator=self.webpackChunkcost_calculator||[]).push([[235],{2235:(it,Z,r)=>{r.r(Z),r.d(Z,{CategoryModule:()=>ot});var u=r(607),S=r(6019),b=r(1702),x=r(9843),F=r(8363),s=r(9133),h=r(4069),m=r(1292),t=r(3668);let I=(()=>{class o{constructor(e,a){this.dialogRef=e,this.data=a}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.so),t.Y36(m.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-confirm-dialog"]],decls:7,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"float","right","margin","20px"],["type","button","value","Sil","color","primary","mat-raised-button","",2,"margin","0px 10px",3,"mat-dialog-close"],["type","button","value","\u0130ptal","color","secondary","mat-raised-button","",3,"mat-dialog-close"]],template:function(e,a){1&e&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1),t._uU(3),t.qZA(),t.TgZ(4,"div",2),t._UZ(5,"input",3),t._UZ(6,"input",4),t.qZA()),2&e&&(t.xp6(1),t.Oqu(a.data.title),t.xp6(2),t.hij(" ",a.data.message,"\n"),t.xp6(2),t.Q6J("mat-dialog-close",!0),t.xp6(1),t.Q6J("mat-dialog-close",!1))},directives:[m.uh,m.xY,m.ZT],styles:[""]}),o})();var l=r(282),T=r(4817),U=r(4021),M=r(1736),D=r(9350),y=r(5243),p=r(1893),R=r(2204),O=r(5093),z=r(2027),$=r(5038),P=r(2450);const J=["paginatorUp"];function Y(o,n){1&o&&(t.TgZ(0,"th",22),t._uU(1," Kategori Kodu "),t.qZA())}function L(o,n){if(1&o&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e.categoryid," ")}}function N(o,n){1&o&&(t.TgZ(0,"th",22),t._uU(1," Kategori Ad\u0131 "),t.qZA())}function Q(o,n){if(1&o&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e.title," ")}}function B(o,n){1&o&&(t.TgZ(0,"th",22),t._uU(1," \u0130\u015flem B\xf6l\xfcm\xfc"),t.qZA())}function k(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"md-cell"),t.TgZ(1,"button",24),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().updateRecord(c)}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA(),t.qZA(),t.TgZ(4,"button",25),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().deleteRecord(c.id)}),t.TgZ(5,"mat-icon"),t._uU(6,"delete_outline"),t.qZA(),t.qZA(),t.qZA()}}function G(o,n){1&o&&t._UZ(0,"tr",26)}function H(o,n){1&o&&t._UZ(0,"tr",27)}let w=(()=>{class o{constructor(e,a,i,c,g,d,at){this.firebaseService=e,this.fb=a,this.dialog=i,this.store=c,this.firestore=g,this.spinnerService=d,this.utilService=at,this.displayedColumns=["position","name","demo-actions"],this.pageSize=10,this.pageSizeOptions=[10,25,50],this.categorySaveMessage="Kategori Ba\u015far\u0131l\u0131 bir \u015feklide eklenmi\u015ftir.",this.categoryDeleteMessage="Kategori Ba\u015far\u0131l\u0131 bir \u015feklide silinmi\u015ftir.",this.categoryUpdateMessage="Kategori Ba\u015far\u0131l\u0131 bir \u015feklide g\xfcncellenmi\u015ftir.",this.reactiveForm()}ngAfterViewInit(){this.Paginator._intl.itemsPerPageLabel="Her sayfada",this.Paginator._intl.nextPageLabel="Sonraki Sayfa",this.Paginator._intl.previousPageLabel="\xd6nceki Sayfa"}ngOnInit(){this.mode="create",this.getItems()}getItems(){this.firebaseService.IsCategoriesInLocalStorage()||this.firebaseService.getCategories(),this.categories$=this.firebaseService.categories$,this.categories$=this.categories$.pipe((0,h.UI)(a=>(a.sort(this.sortByTitle),a)));let e=this.categories$.pipe((0,h.UI)(a=>a.slice(0,10)));this.dataSource=e,this.mode="create",this.dataSource.paginator=this.Paginator}reactiveForm(){this.categoryForm=this.fb.group({title:["",[s.kI.required,s.kI.minLength(3),s.kI.maxLength(50)]]})}submitForm(){this.spinnerService.display(!0),"create"==this.mode?(this.localCategory={categoryid:this.getMaxCategoryId(),title:this.categoryForm.controls.title.value,remarks:""},this.firestore.collection("category").add(this.localCategory).then(e=>{console.log("add item console:"+e.id),this.localCategory.id=e.id,this.spinnerService.sendClickEvent(this.categorySaveMessage),this.localStorageOperation("create",this.localCategory),this.generalOperationAfterCrud()}).catch(e=>{console.log("add item error:"+e)})):(this.localCategory={categoryid:this.updatedRecord.categoryid,title:this.categoryForm.controls.title.value,remarks:""},this.firebaseService.updateCategory(this.localCategory,this.updatedRecord.id).then(e=>{this.localCategory.id=this.updatedRecord.id,this.spinnerService.sendClickEvent(this.categoryUpdateMessage),this.localStorageOperation("update",this.localCategory),this.generalOperationAfterCrud()}).catch(e=>{console.log(e)})),this.spinnerService.display(!1)}cancel(){this.categoryForm.reset(),this.categoryForm.markAsPristine(),this.categoryForm.markAsUntouched(),this.localCategory=null,this.mode="create",this.updatedRecord=null}getMaxCategoryId(){return this.categories$.subscribe(e=>{this.categoryArr=e}),Math.max.apply(Math,this.categoryArr.map(function(e){return e.categoryid}))+1}deleteRecord(e){console.log("Deleted recor is: "+e),this.deletedRecordId=e,this.dialog.open(I,{data:{title:"Category Silme Do\u011frulama",message:"Silmek istedi\u011finizden emin misiniz?"}}).afterClosed().subscribe(i=>{!0===i&&(this.localCategory={id:e,remarks:"",categoryid:999,title:""},this.localStorageOperation("delete",this.localCategory),this.firebaseService.deleteCategorie(e),this.mode="create",this.removeItemFromObservable(this.deletedRecordId),this.spinnerService.sendClickEvent(this.categoryDeleteMessage),this.dataSource=this.categories$,this.localCategory=null,this.table.renderRows())})}removeItemFromObservable(e){this.categories$=this.categories$.pipe((0,h.UI)(a=>a.filter(i=>i.id!=e)))}updateRecord(e){this.mode="update",this.categoryForm.patchValue({title:e.title}),this.updatedRecord=e}sortByTitle(e,a){return a.title>e.title?-1:a.title<e.title?1:0}generalOperationAfterCrud(){this.categoryForm.reset(),this.categoryForm.markAsPristine(),this.categoryForm.markAsUntouched(),this.mode="create",this.updatedRecord=null,this.categories$.subscribe(e=>{e.push(this.localCategory)}),this.dataSource=this.categories$,this.localCategory=null,this.table.renderRows()}localStorageOperation(e,a){let i=JSON.parse(localStorage.getItem("categories"));switch(e){case"update":i.find(d=>d.id==a.id).title=a.title;let c=i.findIndex(d=>d.id==a.id);i[c].title=a.title;break;case"delete":a=i.find(d=>d.id==a.id);let g=i.findIndex(d=>d==a);i.splice(g,1);break;case"create":i.push(a);break;default:console.log(`Sorry, we are out of ${e}.`)}this.utilService.removeItemFromLocalStorage(),localStorage.setItem("categories",JSON.stringify(i)),this.firebaseService.updateGeneralInfo()}getPaginatorData(e){this.pageSize=e.pageSize,this.currentPage=e.currentPage,console.log(e);const a=(e.pageIndex+1)*this.pageSize,i=e.pageIndex*this.pageSize;this.categories$=this.categories$.pipe((0,h.UI)(g=>(g.slice(i,a),g)));let c=this.categories$.pipe((0,h.UI)(g=>g.slice(i,a)));return this.dataSource=c,this.dataSource.paginator=this.Paginator,e}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(T.D),t.Y36(s.qu),t.Y36(m.uw),t.Y36(u.yh),t.Y36(U.ST),t.Y36(M.V),t.Y36(D.t))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-category"]],viewQuery:function(e,a){if(1&e&&(t.Gf(J,5),t.Gf(l.BZ,5)),2&e){let i;t.iGM(i=t.CRH())&&(a.Paginator=i.first),t.iGM(i=t.CRH())&&(a.table=i.first)}},decls:36,vars:15,consts:[[1,"container"],["fxLayoutAlign","center center",1,"mat-display-3","special-header"],["fxLayout","row","fxLayoutAlign","center none",1,"container"],["fxFlex","95%"],["autocomplete","off",3,"formGroup","ngSubmit"],["mat-dialog-title",""],[1,"row"],[3,"formControl","label","error","minlength","maxlength"],["color","primary","mat-raised-button","",3,"disabled"],["color","secondary","mat-raised-button","",3,"click"],[1,"mat-divider"],[3,"pageSize","length","pageSizeOptions","page"],["paginatorUp",""],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","position"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","demo-actions"],[4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary","matTooltip","G\xfcncelle","matTooltipPosition","right","aria-label","Example icon button with a home icon",3,"click"],["mat-icon-button","","color","warn","matTooltip","Sil","matTooltipPosition","right","aria-label","Example icon button with a home icon",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t._uU(2," Kategori Tan\u0131mlama "),t.qZA(),t.TgZ(3,"mat-dialog-content"),t.TgZ(4,"div",2),t.TgZ(5,"div",3),t.TgZ(6,"form",4),t.NdJ("ngSubmit",function(){return a.categoryForm.valid&&a.submitForm()}),t.TgZ(7,"mat-card"),t.TgZ(8,"mat-card-header"),t.TgZ(9,"mat-card-title"),t._UZ(10,"h2",5),t.qZA(),t.qZA(),t.TgZ(11,"mat-card-content"),t.TgZ(12,"div",6),t.TgZ(13,"div"),t._UZ(14,"app-text-input",7),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"mat-card-actions"),t.TgZ(16,"button",8),t._uU(17," Kaydet "),t.qZA(),t.TgZ(18,"button",9),t.NdJ("click",function(){return a.cancel()}),t._uU(19," Temizle "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t._UZ(20,"div",10),t.TgZ(21,"mat-paginator",11,12),t.NdJ("page",function(c){return a.pageEvent=a.getPaginatorData(c)}),t.ALo(23,"async"),t.qZA(),t.TgZ(24,"table",13),t.ynx(25,14),t.YNc(26,Y,2,0,"th",15),t.YNc(27,L,2,1,"td",16),t.BQk(),t.ynx(28,17),t.YNc(29,N,2,0,"th",15),t.YNc(30,Q,2,1,"td",16),t.BQk(),t.ynx(31,18),t.YNc(32,B,2,0,"th",15),t.YNc(33,k,7,0,"md-cell",19),t.BQk(),t.YNc(34,G,1,0,"tr",20),t.YNc(35,H,1,0,"tr",21),t.qZA()),2&e){let i;t.xp6(6),t.Q6J("formGroup",a.categoryForm),t.xp6(8),t.Q6J("formControl",a.categoryForm.controls.title)("label","Kategori ad\u0131")("error","L\xfctfen kategori ad\u0131 giriniz")("minlength","3")("maxlength","40"),t.xp6(2),t.Q6J("disabled",!a.categoryForm.valid),t.xp6(5),t.Q6J("pageSize",a.pageSize)("length",null==(i=t.lcZ(23,13,a.categories$))?null:i.length)("pageSizeOptions",a.pageSizeOptions),t.xp6(3),t.Q6J("dataSource",a.dataSource),t.xp6(10),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns)}},directives:[y.Wh,m.xY,y.xw,y.yH,s._Y,s.JL,s.sg,p.a8,p.dk,p.n5,m.uh,p.dn,R.t,s.JJ,s.oH,s.wO,s.nD,p.hq,O.lW,z.NW,l.BZ,l.w1,l.fO,l.Dz,l.as,l.nj,l.ge,l.ev,$.gM,P.Hw,l.XQ,l.Gk],pipes:[S.Ov],styles:['table[_ngcontent-%COMP%]{width:95%;margin:40px auto 0}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:large;font-weight:bold}.special-header[_ngcontent-%COMP%]{margin:1em 0 .5em;color:#343434;font-weight:normal;font-family:"Ultra",sans-serif;font-size:36px;line-height:42px;text-transform:uppercase;text-shadow:0 2px white,0 3px #777}.mat-paginator[_ngcontent-%COMP%]{display:flex;justify-content:center;font-size:16px!important}']}),o})();var A=r(5568);const E=[{path:"",component:F.$,children:[{path:"",component:w}]}];let K=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[A.e],imports:[[x.Bz.forChild(E)],x.Bz]}),o})();var f=r(1410),j=r(6700),q=r(8053),C=r(4833);let W=(()=>{class o{constructor(e,a){this.actions$=e,this.service=a,this.loadCategories$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(C.R),(0,j.b)(i=>this.service.getCategories()),(0,q.U)(i=>(0,C.b)({categories:i}))))}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(f.eX),t.LFG(T.D))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})();const v=(0,r(2770).H)(),V=v.getInitialState(),_=(0,u.Lq)(V,(0,u.on)(C.b,(o,n)=>v.setAll(n.categories,o)));v.getSelectors();var tt=r(5394);const et={Category:{}};let ot=(()=>{class o{constructor(e){this.eds=e,e.registerMetadataMap(et)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(tt.f0))},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[A.e],imports:[[S.ez,b.m,K,f.sQ.forFeature([W]),u.Aw.forFeature("categories",_)]]}),o})()}}]);